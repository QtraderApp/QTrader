{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://qtrader.dev/schemas/strategy/indicator.v1.json",
    "title": "Indicator Event",
    "description": "Technical indicator calculations emitted by strategies for debugging and analysis. Supports flexible value structures (single values, bands, multiple indicators) with optional metadata.",
    "type": "object",
    "required": [
        "strategy_id",
        "symbol",
        "timestamp",
        "indicators"
    ],
    "properties": {
        "strategy_id": {
            "type": "string",
            "description": "Strategy that calculated these indicators",
            "examples": [
                "sma_crossover",
                "mean_reversion"
            ]
        },
        "symbol": {
            "type": "string",
            "description": "Security symbol for which indicators were calculated",
            "examples": [
                "AAPL",
                "SPY",
                "EURUSD"
            ]
        },
        "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Bar timestamp for which indicators were calculated (ISO 8601 with timezone)"
        },
        "indicators": {
            "type": "object",
            "description": "Dictionary of indicator name to value. Values are completely flexible - can be numeric (int/float), boolean, string, array, or nested object. No schema validation on values to support any custom indicator type.",
            "additionalProperties": {},
            "minProperties": 1,
            "examples": [
                {
                    "sma_fast": 150.25,
                    "sma_slow": 148.50,
                    "crossover": true
                },
                {
                    "rsi": 65.4,
                    "signal": "neutral",
                    "levels": [
                        30,
                        70
                    ]
                },
                {
                    "bbands": {
                        "upper": 152.00,
                        "middle": 150.00,
                        "lower": 148.00
                    },
                    "price_position": "above_upper"
                },
                {
                    "macd": {
                        "value": 2.5,
                        "signal": 1.8,
                        "histogram": 0.7
                    },
                    "divergence": null
                },
                {
                    "custom_ml_score": 0.8456,
                    "confidence_interval": [
                        0.75,
                        0.95
                    ],
                    "features_used": [
                        "volume",
                        "volatility",
                        "momentum"
                    ]
                }
            ]
        },
        "metadata": {
            "type": [
                "object",
                "null"
            ],
            "description": "Optional metadata for additional context. Completely flexible structure - use for signal classification, strategy state, debugging info, etc.",
            "additionalProperties": {},
            "examples": [
                {
                    "signal": "bullish",
                    "strength": "strong"
                },
                {
                    "trend": "uptrend",
                    "volatility_regime": "high",
                    "regime_change": false
                },
                {
                    "debug": {
                        "bars_calculated": 50,
                        "warmup_complete": true
                    }
                }
            ]
        }
    },
    "additionalProperties": false
}
